{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///Users/admin/Desktop/%20aiCoding/MVP/game-deal-frontend/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Image from \"next/image\";\n\n// --- 1. 타입 정의 (Type Definitions) ---\n// API에서 받아올 데이터의 구조를 정의합니다.\n\ninterface XboxMetadata {\n  game_pass_tier: string;\n  is_day_one: boolean;\n  removal_date?: string;\n}\n\ninterface EpicMetadata {\n  is_free_to_keep: boolean;\n}\n\ninterface Deal {\n  id: number;\n  platform: string;\n  title: string;\n  url: string;\n  regular_price: number;\n  sale_price: number;\n  discount_rate: number;\n  deal_type: \"GamePass\" | \"Epic\";\n  image_url?: string; // DB에 현재 없지만 추후 확장을 위해 옵셔널로 정의\n\n  // 관계형 데이터 (Optional)\n  xboxMeta?: XboxMetadata;\n  epicMeta?: EpicMetadata;\n}\n\ninterface ApiResponse {\n  meta: {\n    totalItems: number;\n    totalPages: number;\n    currentPage: number;\n    itemsPerPage: number;\n  };\n  data: Deal[];\n}\n\ntype TabType = \"Xbox\" | \"Epic\";\n\n// --- 2. 메인 컴포넌트 ---\nexport default function Home() {\n  // --- State 관리 ---\n  // useState에 제네릭(<Type>)을 사용하여 타입을 명시합니다.\n  const [deals, setDeals] = useState<Deal[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [activeTab, setActiveTab] = useState<TabType>(\"Xbox\");\n  const [searchTerm, setSearchTerm] = useState<string>(\"\");\n  const [debouncedSearch, setDebouncedSearch] = useState<string>(\"\");\n  const [page, setPage] = useState<number>(1);\n  const [totalPages, setTotalPages] = useState<number>(1);\n\n  // --- 검색어 디바운스 ---\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setDebouncedSearch(searchTerm);\n      setPage(1);\n    }, 500);\n    return () => clearTimeout(timer);\n  }, [searchTerm]);\n\n  // --- 데이터 가져오기 ---\n  useEffect(() => {\n    const fetchDeals = async () => {\n      setLoading(true);\n      try {\n        // axios.get에 응답 타입(ApiResponse)을 지정하여 자동 완성을 지원받습니다.\n        const response = await axios.get<ApiResponse>(\n          \"http://localhost:4000/api/v1/deals\",\n          {\n            params: {\n              page: page,\n              limit: 18,\n              platform: activeTab,\n              search: debouncedSearch,\n            },\n          }\n        );\n        setDeals(response.data.data);\n        setTotalPages(response.data.meta.totalPages);\n      } catch (error) {\n        console.error(\"데이터 불러오기 실패:\", error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchDeals();\n  }, [activeTab, debouncedSearch, page]);\n\n  // --- 렌더링 헬퍼: 뱃지 ---\n  const renderBadges = (deal: Deal) => {\n    if (deal.deal_type === \"GamePass\" && deal.xboxMeta) {\n      const tiers = deal.xboxMeta.game_pass_tier || \"\";\n      return (\n        <div className=\"flex flex-wrap gap-1 mt-2\">\n          {tiers.split(\",\").map((tier, idx) => (\n            <span\n              key={idx}\n              className=\"px-2 py-1 text-[10px] font-bold text-white bg-green-600 rounded uppercase\"\n            >\n              {tier.trim()}\n            </span>\n          ))}\n          {deal.xboxMeta.is_day_one && (\n            <span className=\"px-2 py-1 text-[10px] font-bold text-black bg-yellow-400 rounded uppercase\">\n              Day 1\n            </span>\n          )}\n        </div>\n      );\n    }\n    if (deal.deal_type === \"Epic\" && deal.epicMeta) {\n      return deal.epicMeta.is_free_to_keep ? (\n        <span className=\"px-2 py-1 text-[10px] font-bold text-white bg-blue-600 rounded mt-2 inline-block uppercase\">\n          Free Keep\n        </span>\n      ) : null;\n    }\n    return null;\n  };\n\n  // --- 렌더링 헬퍼: 이미지 ---\n  const getImageSrc = (deal: Deal) => {\n    // DB 필드 부재로 인한 Fallback 이미지 처리\n    return deal.image_url ? deal.image_url : \"/default_thumb.png\";\n  };\n\n  return (\n    <main className=\"min-h-screen bg-gray-100 p-4 md:p-8\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* 헤더 */}\n        <header className=\"mb-8 text-center\">\n          <h1 className=\"text-4xl font-extrabold text-gray-900 mb-2 tracking-tight\">\n            Game Deal Tracker\n          </h1>\n          <p className=\"text-gray-500\">\n            놓치지 말아야 할 게임 패스 & 무료 배포 정보\n          </p>\n        </header>\n\n        {/* 컨트롤 바 (탭 & 검색) */}\n        <div className=\"flex flex-col md:flex-row justify-between items-center mb-8 gap-4\">\n          {/* 탭 버튼 */}\n          <div className=\"bg-white p-1.5 rounded-xl shadow-sm border border-gray-200 flex\">\n            {([\"Xbox\", \"Epic\"] as const).map((tab) => (\n              <button\n                key={tab}\n                onClick={() => {\n                  setActiveTab(tab);\n                  setPage(1);\n                }}\n                className={`px-6 py-2.5 rounded-lg text-sm font-bold transition-all duration-200 ${\n                  activeTab === tab\n                    ? \"bg-gray-900 text-white shadow-md\"\n                    : \"text-gray-500 hover:bg-gray-100 hover:text-gray-700\"\n                }`}\n              >\n                {tab === \"Xbox\" ? \"Xbox Game Pass\" : \"Epic Games\"}\n              </button>\n            ))}\n          </div>\n\n          {/* 검색창 */}\n          <div className=\"relative w-full md:w-80\">\n            <div className=\"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none\">\n              <svg\n                aria-hidden=\"true\"\n                className=\"w-5 h-5 text-gray-400\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth=\"2\"\n                  d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"\n                ></path>\n              </svg>\n            </div>\n            <input\n              type=\"text\"\n              placeholder=\"게임 제목 검색...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all shadow-sm\"\n            />\n          </div>\n        </div>\n\n        {/* 게임 리스트 그리드 */}\n        {loading ? (\n          <div className=\"flex justify-center items-center h-64\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900\"></div>\n          </div>\n        ) : deals.length === 0 ? (\n          <div className=\"text-center py-24 bg-white rounded-2xl border border-gray-200 shadow-sm\">\n            <p className=\"text-gray-500 text-lg\">\n              조건에 맞는 게임을 찾을 수 없습니다.\n            </p>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {deals.map((deal) => (\n              <div\n                key={deal.id}\n                className=\"group bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex flex-col\"\n              >\n                {/* 썸네일 이미지 영역 */}\n                <div className=\"relative w-full h-48 bg-gray-200 overflow-hidden\">\n                  <Image\n                    src={getImageSrc(deal)}\n                    alt={deal.title}\n                    fill\n                    className=\"object-cover group-hover:scale-105 transition-transform duration-500\"\n                    unoptimized={true} // 외부 URL 이미지가 아니라 로컬/fallback이라도 안전하게 처리\n                  />\n                  {/* 플랫폼 라벨 */}\n                  <div className=\"absolute top-3 left-3 bg-black/70 backdrop-blur-md text-white text-[10px] font-bold px-2 py-1 rounded-md uppercase tracking-wider\">\n                    {deal.platform.replace(/, /g, \" · \")}\n                  </div>\n                </div>\n\n                {/* 텍스트 정보 영역 */}\n                <div className=\"p-5 flex-1 flex flex-col\">\n                  <h3 className=\"text-lg font-bold text-gray-900 leading-tight mb-2 line-clamp-2\">\n                    {deal.title}\n                  </h3>\n\n                  <div className=\"mt-auto pt-4 border-t border-gray-100 flex items-end justify-between\">\n                    <div className=\"flex flex-col\">\n                      {deal.regular_price > 0 && (\n                        <span className=\"text-xs text-gray-400 line-through mb-0.5\">\n                          ₩{deal.regular_price.toLocaleString()}\n                        </span>\n                      )}\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-blue-600 font-bold text-sm\">\n                          {deal.sale_price === 0\n                            ? deal.deal_type === \"GamePass\"\n                              ? \"구독 포함\"\n                              : \"무료 배포\"\n                            : `₩${deal.sale_price.toLocaleString()}`}\n                        </span>\n                      </div>\n                      {renderBadges(deal)}\n                    </div>\n\n                    <a\n                      href={deal.url}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"bg-gray-900 hover:bg-gray-800 text-white text-xs font-bold px-4 py-2 rounded-lg transition-colors\"\n                    >\n                      스토어 →\n                    </a>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n\n        {/* 페이지네이션 */}\n        {deals.length > 0 && (\n          <div className=\"flex justify-center mt-12 gap-2\">\n            <button\n              disabled={page === 1}\n              onClick={() => setPage(page - 1)}\n              className=\"px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm font-medium hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              이전\n            </button>\n            <span className=\"px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm font-bold text-gray-700\">\n              {page} / {totalPages}\n            </span>\n            <button\n              disabled={page === totalPages}\n              onClick={() => setPage(page + 1)}\n              className=\"px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm font-medium hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              다음\n            </button>\n          </div>\n        )}\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}